"use strict";document.addEventListener("DOMContentLoaded",(function(){document.getElementById("download").addEventListener("click",(function(){try{(function(t){return new Promise((function(e,n){var r=[];try{var c=Object.keys(t[0]);r.push(c),Array.prototype.forEach.call(t,(function(t){var e=[];Array.prototype.forEach.call(c,(function(n){var r=t[n]||"無";e.push(r)})),r.push(e)}))}catch(t){n(t)}e(r)}))})(JSON.parse(document.getElementById("textarea").value)).then((function(t){return function(t){var e="";Array.prototype.forEach.call(t,(function(t){var n=t.join(",")+"\n";e+=n}));var n="下載資料_"+(new Date).getTime()+".csv",r=document.createElement("a");r.setAttribute("href","data:text/csv;charset=utf-8,%EF%BB%BF"+encodeURI(e)),r.setAttribute("download",n),r.click()}(t)})).catch((function(t){return window.alert(t)}))}catch(t){window.alert(t)}}))}));